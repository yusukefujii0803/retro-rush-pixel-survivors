# RETRO★RUSH 開発ガイドライン

## 開発理念

### AIペアプログラミング優先
- 設計段階からClaudeなどのAIツールを積極活用
- コード生成、レビュー、テスト作成にAIを活用
- 不明点はAIに質問し、学習しながら開発を進める

### 段階的リリース
- 小さく作って素早くリリース
- ユーザーフィードバックを即座に反映
- 完璧を求めず、動くものを優先

## コーディング規約

### 命名規則
```javascript
// クラス名: PascalCase
class PlayerCharacter {}

// 関数名: camelCase
function jumpAction() {}

// 定数: UPPER_SNAKE_CASE
const MAX_HEALTH = 3;

// ファイル名: kebab-case
// player-controller.js
```

### ディレクトリ構造
```
RETRO★RUSH/
├── src/
│   ├── scenes/        # ゲームシーン
│   ├── sprites/       # スプライトクラス
│   ├── utils/         # ユーティリティ関数
│   ├── config/        # 設定ファイル
│   └── main.js        # エントリーポイント
├── assets/
│   ├── sprites/       # 画像ファイル
│   ├── audio/         # 音声ファイル
│   └── data/          # JSONデータ
├── tests/             # テストファイル
└── docs/              # ドキュメント
```

### コード品質
- ESLintによる自動フォーマット必須
- 関数は30行以内を目安
- 1ファイル200行以内を推奨
- マジックナンバーは定数化

## 開発フロー

### 1. 機能開発の手順
1. GitHubでIssue作成
2. ブランチ作成: `feature/機能名`
3. 実装とローカルテスト
4. プルリクエスト作成
5. AIレビュー実施
6. マージ後、自動デプロイ確認

### 2. コミットメッセージ
```
feat: 新機能追加
fix: バグ修正
docs: ドキュメント更新
style: コード整形
refactor: リファクタリング
test: テスト追加
chore: ビルド設定など
```

### 3. ブランチ戦略
- `main`: 本番環境
- `develop`: 開発環境
- `feature/*`: 機能開発
- `hotfix/*`: 緊急修正

## テスト方針

### MVP段階
- 手動テストを中心に実施
- クリティカルパスのみ自動テスト
- ブラウザ互換性: Chrome/Safari/Firefox最新版

### 本格開発段階
- 単体テスト: Jest使用
- E2Eテスト: Playwright使用
- カバレッジ目標: 70%以上

## アセット管理

### 画像ファイル
- 形式: PNG（透過あり）
- 命名: `[カテゴリ]_[名前]_[サイズ].png`
- 例: `player_idle_32x32.png`

### 音声ファイル
- 形式: OGG Vorbis
- 命名: `[タイプ]_[名前].ogg`
- 例: `sfx_jump.ogg`, `bgm_stage1.ogg`

### アニメーション定義
- Asepriteで作成
- JSONエクスポートで管理
- フレームレートは統一（12fps推奨）

## パフォーマンス最適化

### 優先事項
1. 60FPS維持が最優先
2. メモリリーク防止
3. アセット遅延読み込み

### 計測と改善
- Chrome DevToolsでプロファイリング
- 定期的なパフォーマンステスト
- ボトルネック特定と改善

## デプロイメント

### 自動デプロイ設定
```yaml
# Vercel設定
- mainブランチ: 本番環境
- developブランチ: ステージング環境
- PRごとにプレビュー環境
```

### ビルド最適化
- Viteによるバンドル最適化
- Brotli圧縮有効化
- CDN活用（画像、フォント）

## セキュリティ

### 基本方針
- 環境変数でAPIキー管理
- クライアントサイドに機密情報を置かない
- HTTPS必須

### マルチプレイヤー実装時
- 入力検証をサーバー側で実施
- レート制限の実装
- チート対策の段階的強化

## ドキュメント管理

### 必須ドキュメント
- README.md: プロジェクト概要
- GAME_RULES.md: ゲームルール
- API_DOCS.md: API仕様（フェーズ3以降）
- CHANGELOG.md: 変更履歴

### 更新ルール
- 機能追加時は同時にドキュメント更新
- 重要な設計変更は設計書に反映
- ユーザー向け変更はCHANGELOGに記載

## トラブルシューティング

### よくある問題と対処
1. **ビルドエラー**: `npm install`でパッケージ再インストール
2. **描画遅延**: スプライト数を確認、バッチ処理を検討
3. **音声再生エラー**: ユーザー操作後に音声初期化

### エスカレーション
1. 15分悩んだらAIに相談
2. AIで解決しない場合はGitHub Issueに記載
3. 緊急時はチームチャットで相談